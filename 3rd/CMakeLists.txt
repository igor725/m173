cmake_minimum_required(VERSION 3.25)

set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_EXTENSIONS OFF)
set(CMAKE_INSTALL_MESSAGE LAZY)

project(m173third)
include(ExternalProject)

set(INSTALL_DIR ${CMAKE_SOURCE_DIR}/install)

ExternalProject_Add(sockpp
  SOURCE_DIR ${CMAKE_SOURCE_DIR}/sockpp
  BINARY_DIR "${CMAKE_BINARY_DIR}/sockpp-build"
  CMAKE_ARGS
    -DSOCKPP_BUILD_SHARED=OFF
    -DSOCKPP_BUILD_STATIC=ON
    -DCMAKE_INSTALL_PREFIX=${INSTALL_DIR}
)

ExternalProject_Add(spdlog
  SOURCE_DIR ${CMAKE_SOURCE_DIR}/spdlog
  BINARY_DIR "${CMAKE_BINARY_DIR}/spdlog-build"
  CMAKE_ARGS
    -DSPDLOG_BUILD_EXAMPLE=OFF
    -DCMAKE_INSTALL_PREFIX=${INSTALL_DIR}
)

ExternalProject_Add(zlib
  SOURCE_DIR ${CMAKE_SOURCE_DIR}/zlib
  BINARY_DIR "${CMAKE_BINARY_DIR}/zlib-build"
  CMAKE_ARGS
    -DRENAME_ZCONF=OFF
    -DZLIB_BUILD_EXAMPLES=OFF
    -DCMAKE_INSTALL_PREFIX=${INSTALL_DIR}
)
